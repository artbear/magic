
Функция ИзвлечьПодстрокиПоНачалуИОкончанию(ИсходнаяСтрока, НачинаетсяС, ОканчиваетсяНа) Экспорт
	
	СимволПереносаСтроки = Строка(Новый УникальныйИдентификатор);
	КопияИсходнойСтроки = СтрЗаменить(ИсходнаяСтрока, Символы.ПС, СимволПереносаСтроки); // получили текст в одну строку
	
	СимволНачалаПодстроки = СтрЗаменить(НачинаетсяС, Символы.ПС, СимволПереносаСтроки);
	СимволКонцаПодстроки = СтрЗаменить(ОканчиваетсяНа, Символы.ПС, СимволПереносаСтроки);
	КопияИсходнойСтроки = СтрЗаменить(КопияИсходнойСтроки, СимволНачалаПодстроки, Символы.ПС + СимволНачалаПодстроки);
	
	МассивПодстрок = Новый Массив;
	Для сч = 2 По СтрЧислоСтрок(КопияИсходнойСтроки) Цикл
		Подстрока = СтрПолучитьСтроку(КопияИсходнойСтроки, сч);
		Подстрока = СтрЗаменить(Подстрока, СимволКонцаПодстроки, СимволКонцаПодстроки + Символы.ПС);
		Подстрока = СтрПолучитьСтроку(Подстрока, 1);
		Подстрока = СтрЗаменить(Подстрока, СимволПереносаСтроки, Символы.ПС);
		МассивПодстрок.Добавить(Подстрока);
	КонецЦикла;
	
	Возврат МассивПодстрок;
КонецФункции

Функция ВставитьСтрокуПередПодстрокой(ИсходнаяСтрока, ВставляемаяПодстрока, ПодстрокаМаркер) Экспорт
	Возврат СтрЗаменить(ИсходнаяСтрока, ПодстрокаМаркер, ВставляемаяПодстрока + ПодстрокаМаркер);
КонецФункции



