
// варианты открытия эксель
// 1. Классический - 
//		ПриложениеЭксель = Новый COMОбъект("Excel.Application");
//		Книга = ПриложениеЭксель.Workbooks.Open(ПутьКФайлуЭксель);
// 2. Открыть файл через программу по умолчанию
//		Книга = ПолучитьCOMОбъект(ПутьКФайлуЭксель);
// 3. Через макет с типом активдокумент
//		Книга = ПолучитьМакет("МакетЭксельАктивДокумент").Получить();

Функция ПолучитьКнигуЭксель(ПутьКФайлуЭксель, ПриложениеЭксель)
	
    ПриложениеЭксель = Новый COMОбъект("Excel.Application");
    Возврат ПриложениеЭксель.Workbooks.Open(ПутьКФайлуЭксель);
	
КонецФункции

Процедура ЗакрытьКнигуИЭксель(Книга, ПриложениеЭксель)
	Книга.Close();
	ПриложениеЭксель.Quit()
КонецПроцедуры


Функция ПолучитьКнигуВВидеСоответствияКомМассивов(ПутьКФайлуЭксель) Экспорт
	
	СоответствиеКомМассивов = Новый Соответствие;
	
	ПриложениеЭксель = Неопределено;
	Книга = ПолучитьКнигуЭксель(ПутьКФайлуЭксель, ПриложениеЭксель);
	Для сч = 1 по Книга.Sheets.Count Цикл
		
		Страница = Книга.Sheets(Сч);
		
		МассивКОМ = Страница.UsedRange.Value.Выгрузить(); // считывание в массив COMSafeArray
		
		СоответствиеКомМассивов.Вставить(Страница.Name, МассивКОМ);
		
	КонецЦикла;
	
	ЗакрытьКнигуИЭксель(Книга, ПриложениеЭксель);
	
	
	Возврат СоответствиеКомМассивов;
	
КонецФункции


